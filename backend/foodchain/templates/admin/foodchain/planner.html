{% extends 'admin/base_site.html' %}

{% block content %}

<h1>Route Planner</h1>

<h2>Parameters</h2>
<form method="post">{% csrf_token %}
<table>
{{ form }}
</table>
<input type="submit" name="submit" value="Reschedule" /> <input type="submit" name="clear_plan" value="Clear plan" />
</form>

<h2>Current Schedule</h2>

{% if drives %}

<script type="text/javascript"
  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAHNzcZ7GiMUGjA2cVeTjsktAMzM3hJq2M&sensor=false">
</script>
<script type="text/javascript">
var jsData = {{ js_data|safe }};

  function initialize() {
    var mapOptions = {
      center: new google.maps.LatLng(51.5072, -0.1075),
      zoom: 11,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    googleMap = new google.maps.Map(document.getElementById("map-canvas"),
        mapOptions);
    
    for (var i = 0; i < jsData.kitchens.length; i++) {
    	var k = jsData.kitchens[i];
    	new google.maps.Marker({
    		map: googleMap,
    		position: new google.maps.LatLng(k.lat, k.lng),
    		title: k.kitchen_id
    	});
    }
  }
  google.maps.event.addDomListener(window, 'load', initialize);
</script>
<div id="map-canvas" style="width: 700px; height: 500px"></div>

<h4>Kitchen Statistics</h4>
<table cellpadding="8">
<tr><th></th><th>Number of drives</th><th>Number of meals</th><th>Maximum capacity</th></tr>
{% for kitchen in kitchens %}
<tr><th>{{ kitchen.kitchen_id }}</th><td>{{ kitchen.num_drives }}</td>
<td>{{ kitchen.num_meals }}</td><td>{{ kitchen.capacity }}</td></tr>
{% endfor %}
</table>

{% else %}
Plan is not available.
{% endif %}


{% endblock %}